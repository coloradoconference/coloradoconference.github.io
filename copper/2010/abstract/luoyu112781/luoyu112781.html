<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.70)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>luoyu112781</TITLE>
<META NAME="description" CONTENT="luoyu112781">
<META NAME="keywords" CONTENT="luoyu112781">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="luoyu112781.css">

<LINK REL="next" HREF="node1.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html2"
  HREF="node1.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/share/latex2html/icons/next.png"></A> 
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/share/latex2html/icons/up_g.png"> 
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/share/latex2html/icons/prev_g.png">   
<BR>
<B> Next:</B> <A NAME="tex2html3"
  HREF="node1.html">About this document ...</A>
<BR>
<BR>
<!--End of Navigation Panel-->
<DIV ALIGN="CENTER">
  <FONT SIZE="+1">Yuancheng Luo 
<BR><B>Updated QR Decompositions for Efficient NNLS and its GPU Parallelization</B></FONT>
</DIV>
<P>
<DIV ALIGN="CENTER">3368 A V Williams Building 
<BR>
University of Maryland 
<BR>
College Park 
<BR>
MD 20742-3255

<BR><TT>yluo1@umd.edu</TT>
<BR>
Ramani Duraiswami
</DIV>

<P>
In many signal processing applications, the non-negative least squares
problem (NNLS) of ``moderate'' size (in a few hundred to a thousand
variables) arises. Efficient solutions of these problems would enable
online applications, in which the estimation can be performed as data is
acquired. We parallelize a version of the <EM>active-set</EM> iterative
algorithm derived from the original algorithm of Lawson and Hanson (1974)
on a graphics processor. This algorithm requires the solution of an
unconstrained least squares problem in every step of the iteration for a
matrix composed of the ``passive columns'' of the original system matrix.
To achieve improved performance we use parallelizable procedures to
efficiently update and ``downdate'' the QR factorization of the matrix at
the current iteration to account for inserted and removed columns, and
efficient data structures that account for GPU memory access patterns.

<P>
The NNLS problem has roots in data-modelling where we optimize a set of
underlying parameters that is used to describe observed data. The
underlying parameters denote a set <IMG
 WIDTH="18" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img1.png"
 ALT="$ m$"> variables in a <!-- MATH
 $m\times{1}$
 -->
<IMG
 WIDTH="46" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$ m\times{1}$"> vector
<!-- MATH
 $x=\{x_1,x_2,\cdots,x_m\}^T$
 -->
<IMG
 WIDTH="159" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="img3.png"
 ALT="$ x=\{x_1,x_2,\cdots,x_m\}^T$">. The observed data is composed of <IMG
 WIDTH="14" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$ n$">
observations in a <!-- MATH
 $n\times{1}$
 -->
<IMG
 WIDTH="41" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img5.png"
 ALT="$ n\times{1}$"> vector <!-- MATH
 $b=\{b_1,b_2,\cdots,b_n\}^T$
 -->
<IMG
 WIDTH="147" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="img6.png"
 ALT="$ b=\{b_1,b_2,\cdots,b_n\}^T$">.
Suppose that the observed data are linear functions of the underlying
parameters in the model, then the linear functions may be expressed as a
<!-- MATH
 $n\times{m}$
 -->
<IMG
 WIDTH="47" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img7.png"
 ALT="$ n\times{m}$"> matrix <IMG
 WIDTH="16" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img8.png"
 ALT="$ A$"> where <IMG
 WIDTH="54" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img9.png"
 ALT="$ Ax=b$"> describes a linear mapping from the
parameters in <IMG
 WIDTH="14" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img10.png"
 ALT="$ x$"> to the observations in <IMG
 WIDTH="11" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img11.png"
 ALT="$ b$">.

<P>
In the general case where <IMG
 WIDTH="49" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img12.png"
 ALT="$ n\geq{m}$">, the dense overdetermined system of
linear equations may be solved via a least squares approach by
decomposing matrix <IMG
 WIDTH="62" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img13.png"
 ALT="$ A=QR$"> where <IMG
 WIDTH="17" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img14.png"
 ALT="$ Q$"> is an orthogonal <!-- MATH
 $n\times{m}$
 -->
<IMG
 WIDTH="47" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img7.png"
 ALT="$ n\times{m}$"> matrix
and <IMG
 WIDTH="17" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img15.png"
 ALT="$ R$"> is an upper-triangular <!-- MATH
 $m\times{m}$
 -->
<IMG
 WIDTH="52" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img16.png"
 ALT="$ m\times{m}$"> matrix. The resulting matrix
equation may be rearranged as <IMG
 WIDTH="76" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="img17.png"
 ALT="$ Rx=Q^Tb$"> and solved via back-substitution.

<P>
Sometimes, the underlying parameters are constrained to be non-negative
in order to reflect real-world prior information. When the data is
corrupted by noise, the estimated parameters may not satisfy these
constraints, producing answers which are not usable. In these cases, it
is necessary to explicitly enforce the non-negativity constraints and so
we solve for
<!-- MATH
 \begin{displaymath}
\begin{array}{c}
\min_xf(x)=\frac{1}{2}\|Ax-b\|^2,\qquad x_i\geq 0.
\end{array}\nonumber
\end{displaymath}
 -->
<P></P>
<DIV ALIGN="CENTER">
<IMG
 WIDTH="256" HEIGHT="39" BORDER="0"
 SRC="img18.png"
 ALT="\begin{displaymath}
\begin{array}{c}
\min_xf(x)=\frac{1}{2}\Vert Ax-b\Vert^2,\qquad x_i\geq 0.
\end{array}\nonumber
\end{displaymath}">
</DIV><P></P>

<P>
The seminal work of Lawson and Hanson in ref. [3] provided the first
widely used method for solving this NNLS problem. This algorithm, later
referred to as the active-set method, partitions the set of parameters or
variables into the active and passive-sets. The active-set contains the
variables with value zero and those that violate the constraints in the
problem. The passive-set contains the variables that do not violate the
constraint. By iteratively updating a feasibility vector with components
from the passive-set, each iteration is reduced to an unconstrained
linear least squares sub-problem that is solvable via <IMG
 WIDTH="29" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img19.png"
 ALT="$ QR$">.

<P>
We denote the unconstrained sub-problem as the linear system <IMG
 WIDTH="63" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="img20.png"
 ALT="$ A^Py=b$">
where matrix <IMG
 WIDTH="27" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img21.png"
 ALT="$ A^P$"> contains the column vectors in matrix <IMG
 WIDTH="16" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img8.png"
 ALT="$ A$"> that
correspond to variables in the passive-set. Observe that any changes
between the active and passive-sets at each iteration are generally
limited to the exchange of a single variable; usually one column vector
is added or removed from <IMG
 WIDTH="27" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img21.png"
 ALT="$ A^P$"> at each iteration. We make an important
distinction that exchanged variables that have remained in the same set
throughout several iterations have a lower propensity for future
exchanges. This leads to an efficient algorithm that does not recompute
the entire <IMG
 WIDTH="73" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="img22.png"
 ALT="$ A^P=QR$"> decomposition at each step but rather modifies
previous <IMG
 WIDTH="17" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img14.png"
 ALT="$ Q$"> and <IMG
 WIDTH="17" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img15.png"
 ALT="$ R$"> matrices with regards to two cases:

<OL>
<LI>A new variable added to set <IMG
 WIDTH="17" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img23.png"
 ALT="$ P$"> expands or updates matrix <IMG
 WIDTH="27" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img21.png"
 ALT="$ A^P$"> by a single column.
</LI>
<LI>The removal of a variable from set <IMG
 WIDTH="17" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img23.png"
 ALT="$ P$"> shrinks or downdates matrix
<IMG
 WIDTH="27" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img21.png"
 ALT="$ A^P$"> by a single column.
</LI>
</OL>
Furthermore, we maintain a separate ordering for the columns of <IMG
 WIDTH="27" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img21.png"
 ALT="$ A^P$"> by
the relative time of insertions and deletions over iterations. This
stack-like ordering ensures that variables more recently added to set <IMG
 WIDTH="17" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img23.png"
 ALT="$ P$">
are placed near the top and computationally less expensive to update.
Similarly, variables to be removed from set <IMG
 WIDTH="17" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img23.png"
 ALT="$ P$"> are likely located near
the top and are computationally less expensive to downdate.

<P>
Our update procedure is based on the modified Gram-Schmidt algorithm for
orthogonalizing the inserted column with respect to all the existing
columns in <IMG
 WIDTH="17" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img14.png"
 ALT="$ Q$">. The time-complexity of the update step is <IMG
 WIDTH="53" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img24.png"
 ALT="$ O(nm)$">. The
parallel time-complexity is <!-- MATH
 $O(m\log{n})$
 -->
<IMG
 WIDTH="79" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img25.png"
 ALT="$ O(m\log{n})$">. The downdate procedure
involves a series of Given's rotations that introduces zeros to a single
row of <IMG
 WIDTH="17" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img15.png"
 ALT="$ R$">. The time-complexity of the downdate step is <IMG
 WIDTH="53" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img24.png"
 ALT="$ O(nm)$">. The
parallel time-complexity is <IMG
 WIDTH="43" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img26.png"
 ALT="$ O(m)$">.

<P>
We implement our algorithm on NVIDIA's Compute Unified Device
Architecture. For a comparison, Matlab's built-in lsqnonneg routine
implements a version of the Lawson and Hanson active-sets algorithm that
solves the sub-problem via a full <IMG
 WIDTH="29" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img19.png"
 ALT="$ QR$"> decomposition based on Intel's
optimized Math Kernel Library code-base. Other active-set variants in
literature include the Fast NNLS (FNNLS) algorithm in ref. [1] and the
Projective Quasi-Newton NNLS (PQN-NNLS) algorithm in ref. [2]. For
experiments results, we apply the listed algorithms to a deconvolution
problem with data obtained from terrain laser imaging. We show that our
algorithm achieves a moderate speed-up over the lsqnonneg routine and a
substantial speed-up over the FNNLS and PQN-NNLS algorithms for our
data-set.

<P>
<BR>
<BR>
<BR>

<P>
<FONT SIZE="+2"><B>References</B></FONT>
<DL COMPACT>
<DT>[1]</DT>
<DD>R. Bro, S. D. Jong, A fast non-negativity-constrained least
squares algorithm, Journal of Chemometrics, Vol. 11, No. 5, pp. 393-401,
1997.

<P>
</DD>
<DT>[2]</DT>
<DD>D. Kim, S. Sra, and I. S. Dhillon, A New Projected
Quasi-Newton Approach for the Non-negative Least Squares Problem.
Technical Report TR-06-54, Computer Sciences, The Univ. of Texas at
Austin, 2006.

<P>
</DD>
<DT>[3]</DT>
<DD>C. L. Lawson and R. J. Hanson, Solving Least Squares
Problems, PrenticeHall, 1987.
</DD>
</DL>

<P>
<BR><HR>
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"></A>

<UL>
<LI><A NAME="tex2html4"
  HREF="node1.html">About this document ...</A>
</UL>
<!--End of Table of Child-Links-->
<HR>
<!--Navigation Panel-->
<A NAME="tex2html2"
  HREF="node1.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/share/latex2html/icons/next.png"></A> 
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/share/latex2html/icons/up_g.png"> 
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/share/latex2html/icons/prev_g.png">   
<BR>
<B> Next:</B> <A NAME="tex2html3"
  HREF="node1.html">About this document ...</A>
<!--End of Navigation Panel-->
<ADDRESS>
root
2010-03-03
</ADDRESS>
</BODY>
</HTML>
