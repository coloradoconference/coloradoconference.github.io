<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.70)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Heroux</TITLE>
<META NAME="description" CONTENT="Heroux">
<META NAME="keywords" CONTENT="Heroux">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="Heroux.css">

<LINK REL="next" HREF="node1.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html2"
  HREF="node1.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="http://amath.colorado.edu/PNGs/icons.png/next.png"></A> 
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="http://amath.colorado.edu/PNGs/icons.png/up_g.png"> 
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="http://amath.colorado.edu/PNGs/icons.png/prev_g.png">   
<BR>
<B> Next:</B> <A NAME="tex2html3"
  HREF="node1.html">About this document ...</A>
<BR>
<BR>
<!--End of Navigation Panel-->


<P>
<DIV ALIGN="CENTER">
<FONT SIZE="+1"><B>A multiscale perspective on density functional theory 
<BR>
for inhomogeneous fluids</B></FONT>
</DIV>
<P>
<DIV ALIGN="CENTER">Michael A Heroux 
<BR>
18125 Kreigle Lake Rd,  Avon MN 56310 
<BR>	<TT>maherou@sandia.gov</TT> 
<BR>
Laura J D Frink, Andrew G Salinger

</DIV>
Some modeling and simulations efforts have historically
encompassed multiscale phenomena without explicitly handling
multiscale features. One such area is density functional
theories for inhomogeneous fluids (Fluid-DFTs). In this
presentation we look at Fluid-DFTs from a fresh perspective,
calling out the fact that Fluid-DFTs incorporate multiple
length scales that are introduced in a way such that each
longer scale increases the fidelity of the model. By viewing
Fluid-DFTs from this perspective, we develop a mathematical
framework and a collection of solution algorithms that have
a dramatic impact on the robustness, performance and
scalability of the implicit equations generated by
Fluid-DFTs.

<P>
The basic
framework for all of our solver algorithms reflects the
importance of inter-physics coupling in the extended
variable formulation of the
Fluid-DFTs.
This physics coupling led
us to a physics-based block matrix formulation in order to
partition critical and nonlocal ancillary variables. The
idea is to partition the data into blocks that can be
optimally managed or solved. The general <IMG
 WIDTH="38" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img1.png"
 ALT="$ 2\times 2$"> block
matrix is

<P>
<!-- MATH
 \begin{displaymath}
\left(
\begin{array}{ccc|ccc} A_{11}^{11} & \cdots & A_{11}^{1j} &
A_{12}^{1,j+1} & \cdots & A_{12}^{1k} \\\vdots & \ddots &
\vdots & \vdots & \ddots & \vdots \\A_{11}^{j1} & \cdots &
A_{11}^{jj} & A_{11}^{j1} & \cdots & A_{11}^{jj} \\\hline
A_{21}^{j+1,1} & \cdots & A_{21}^{j+1,j} & A_{22}^{j+1,j+1}
& \cdots & A_{22}^{j+1,k} \\\vdots & \ddots & \vdots &
\vdots & \ddots & \vdots \\A_{21}^{k1} & \cdots &
A_{21}^{kj} & A_{22}^{k,j+1} & \cdots & A_{22}^{kk} \\
\end{array} \right) \left( \begin{array}{c} x_1^1 \\\vdots
\\x_1^j \\\hline x_2^{j+1} \\\vdots \\x_2^k \\
\end{array} \right) = \left( \begin{array}{c} b_1^1 \\
\vdots \\b_1^j \\\hline b_2^{j+1} \\\vdots \\b_2^k \\
\end{array} \right)
\end{displaymath}
 -->
<P></P>
<DIV ALIGN="CENTER">
<IMG
 WIDTH="525" HEIGHT="150" BORDER="0"
 SRC="img2.png"
 ALT="\begin{displaymath}
\left(
\begin{array}{ccc\vert ccc} A_{11}^{11} &amp; \cdots &amp; A_...
...\\ \hline b_2^{j+1} \\ \vdots \\ b_2^k \\
\end{array} \right)
\end{displaymath}">
</DIV><P></P>
where <IMG
 WIDTH="12" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img3.png"
 ALT="$ k$"> is the number of DOFs
tracked per node. The superscript <IMG
 WIDTH="38" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img4.png"
 ALT="$ (p, q)$"> denotes the block
of coefficients generated by DOF <IMG
 WIDTH="11" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img5.png"
 ALT="$ p$"> interactions with DOF
<IMG
 WIDTH="11" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img6.png"
 ALT="$ q$">. The subscripts and partition lines impose a coarser
partitioning of the matrix into a <IMG
 WIDTH="38" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img1.png"
 ALT="$ 2\times 2$">
block system that
will be used with a Schur complement approach. We denote by
<IMG
 WIDTH="28" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img7.png"
 ALT="$ A_{11}$">, <IMG
 WIDTH="28" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img8.png"
 ALT="$ A_{12}$">, <IMG
 WIDTH="28" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img9.png"
 ALT="$ A_{21}$"> and <IMG
 WIDTH="28" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$ A_{22}$"> the upper left,
upper right, lower left and lower right submatrix of the
coarse <IMG
 WIDTH="38" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img1.png"
 ALT="$ 2\times 2$"> block matrix, respectively. Similarly <IMG
 WIDTH="19" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img11.png"
 ALT="$ x_1$">
and <IMG
 WIDTH="19" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img12.png"
 ALT="$ x_2$">, and <IMG
 WIDTH="17" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img13.png"
 ALT="$ b_1$"> and <IMG
 WIDTH="17" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img14.png"
 ALT="$ b_2$"> are the upper and lower parts
of <IMG
 WIDTH="12" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img15.png"
 ALT="$ x$"> and <IMG
 WIDTH="10" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img16.png"
 ALT="$ b$">, respectively.

<P>
Given this two-level
structure, the basic strategy for solving each global linear
system generated by Newton's method is as follows:

<OL>
<LI>Identify and reorder DOFs <IMG
 WIDTH="11" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img17.png"
 ALT="$ 1$">
through <IMG
 WIDTH="10" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img18.png"
 ALT="$ j$"> such that <!-- MATH
 $A_{11}^{-1}$
 -->
<IMG
 WIDTH="32" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img19.png"
 ALT="$ A_{11}^{-1}$"> (the inverse of
<IMG
 WIDTH="28" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img7.png"
 ALT="$ A_{11}$">) is easy to apply (in parallel).
</LI>
<LI>Determine a
preconditioner <IMG
 WIDTH="15" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img20.png"
 ALT="$ P$"> for <!-- MATH
 $S = A_{22} -
A_{21}A_{11}^{-1}A_{12}$
 -->
<IMG
 WIDTH="160" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img21.png"
 ALT="$ S = A_{22} -
A_{21}A_{11}^{-1}A_{12}$">,
the Schur complement of <IMG
 WIDTH="15" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img22.png"
 ALT="$ A$"> with
respect to <IMG
 WIDTH="28" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$ A_{22}$">.
</LI>
<LI>Solve <!-- MATH
 $Sx_2 = (b_2 - A_{21}b_1)$
 -->
<IMG
 WIDTH="136" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img23.png"
 ALT="$ Sx_2 = (b_2 - A_{21}b_1)$">
using a preconditioned Krylov method such as GMRES, with
preconditioner <IMG
 WIDTH="15" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img20.png"
 ALT="$ P$">. Note that <IMG
 WIDTH="14" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img24.png"
 ALT="$ S$"> may or may not be
explicitly formed, depending on other problem details.
</LI>
<LI>Finally, solve for <!-- MATH
 $x_1 = A_{11}^{-1}(b_1 - A_{12}x_2)$
 -->
<IMG
 WIDTH="157" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img25.png"
 ALT="$ x_1 = A_{11}^{-1}(b_1 - A_{12}x_2)$">.
</LI>
</OL>

<P>
Given this basic framework, we will describe specific
solvers for special categories of Fluid-DFT problems,
including 2 and 3 dimensional hard-sphere problems and
polymer chains. We give results for several problem areas
including nanopore and lipid bi-layer models where this
Schur complement approach provides one to two orders of
magnitude improvement in performance and an order of
magnitude reduction in memory requirements.

<P>
<BR><HR>
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"></A>

<UL>
<LI><A NAME="tex2html4"
  HREF="node1.html">About this document ...</A>
</UL>
<!--End of Table of Child-Links-->
<HR>
<!--Navigation Panel-->
<A NAME="tex2html2"
  HREF="node1.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="http://amath.colorado.edu/PNGs/icons.png/next.png"></A> 
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="http://amath.colorado.edu/PNGs/icons.png/up_g.png"> 
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="http://amath.colorado.edu/PNGs/icons.png/prev_g.png">   
<BR>
<B> Next:</B> <A NAME="tex2html3"
  HREF="node1.html">About this document ...</A>
<!--End of Navigation Panel-->
<ADDRESS>
Bruce Fast
2006-03-11
</ADDRESS>
</BODY>
</HTML>
