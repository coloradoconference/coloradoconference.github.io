<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.70)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Quian</TITLE>
<META NAME="description" CONTENT="Quian">
<META NAME="keywords" CONTENT="Quian">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="Quian.css">

<LINK REL="next" HREF="node1.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html2"
  HREF="node1.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="http://amath.colorado.edu/PNGs/icons.png/next.png"></A> 
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="http://amath.colorado.edu/PNGs/icons.png/up_g.png"> 
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="http://amath.colorado.edu/PNGs/icons.png/prev_g.png">   
<BR>
<B> Next:</B> <A NAME="tex2html3"
  HREF="node1.html">About this document ...</A>
<BR>
<BR>
<!--End of Navigation Panel-->


<P>
<DIV ALIGN="CENTER">
<FONT SIZE="+1"><B>Stochastic preconditioning for iterative linear equation solvers</B></FONT>
</DIV>
<P>
<DIV ALIGN="CENTER">Haifeng Qian 
<BR>
Dept. of Electrical and Computer Engineering, 200 Union Street SE 
<BR>
University of Minnesota, Minneapolis MN 55455 
<BR>	<TT>qianhf@ece.umn.edu</TT> 
<BR>
Sachin Sapatnekar

</DIV>
Stochastic techniques, namely random walks, have been used
to form linear equation solvers since the 1940s, but have
not been used effectively for preconditioning, to the best
of our knowledge. In this talk, we present a new stochastic
preconditioning approach: we prove that for symmetric
diagonally-dominant M-matrices, an incomplete LDL
factorization can be obtained from random walks, and used as
a preconditioner for an iterative solver, e.g., conjugate
gradient. The theory can be extended to general matrices
with nonzero diagonal entries.

<P>
The stochastic
preconditioning is performed by a random walk ``game''
defined as follows. Given a finite undirected connected
graph representing a street map, a walker starts from one of
the nodes, and goes to one of the adjacent nodes every day
with a certain probability. The walker pays an amount of
money, <IMG
 WIDTH="22" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img1.png"
 ALT="$ m_i$"> at node <IMG
 WIDTH="9" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img2.png"
 ALT="$ i$">, to a motel for lodging everyday,
until he/she reaches one of the homes, which are a subset of
the nodes. Then the journey is complete and he/she will be
rewarded a certain amount of money, <IMG
 WIDTH="24" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img3.png"
 ALT="$ m_0$">. The problem is to
determine the gain function:
<!-- MATH
 \begin{displaymath}
f(i)=E[\textrm{money earned }|
\textrm{walk starts at node }i]
\end{displaymath}
 -->
<P></P>
<DIV ALIGN="CENTER">
<IMG
 WIDTH="325" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img4.png"
 ALT="$\displaystyle f(i)=E[\textrm{money earned }\vert
\textrm{walk starts at node }i]
$">
</DIV><P></P>
These gain values satisfy
the following linear equations:
<BR>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{eqnarray*}
& &
f(i)=\sum_{j \in \textrm{neighbors of }i}{p_{i,j}f(j)}-m_i
\quad,\quad \forall i \nonumber \\
& & f(\textrm{a home node}) = m_0
\end{eqnarray*}
 -->
<TABLE CELLPADDING="0" ALIGN="CENTER" WIDTH="100%">
<TR VALIGN="MIDDLE"><TD NOWRAP ALIGN="RIGHT">&nbsp;</TD>
<TD>&nbsp;</TD>
<TD ALIGN="LEFT" NOWRAP><IMG
 WIDTH="289" HEIGHT="54" ALIGN="MIDDLE" BORDER="0"
 SRC="img5.png"
 ALT="$\displaystyle f(i)=\sum_{j \in \textrm{neighbors of }i}{p_{i,j}f(j)}-m_i
\quad,\quad \forall i$"></TD>
<TD WIDTH=10 ALIGN="RIGHT">
&nbsp;</TD></TR>
<TR VALIGN="MIDDLE"><TD NOWRAP ALIGN="RIGHT">&nbsp;</TD>
<TD>&nbsp;</TD>
<TD ALIGN="LEFT" NOWRAP><IMG
 WIDTH="156" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img6.png"
 ALT="$\displaystyle f(\textrm{a home node}) = m_0$"></TD>
<TD WIDTH=10 ALIGN="RIGHT">
&nbsp;</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL">

where <IMG
 WIDTH="26" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img7.png"
 ALT="$ p_{i,j}$">
is the transition probability of going from node <IMG
 WIDTH="9" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img2.png"
 ALT="$ i$"> to node
<IMG
 WIDTH="10" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img8.png"
 ALT="$ j$">, and note that <IMG
 WIDTH="10" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img8.png"
 ALT="$ j$"> can be a home node. Thus a random
walk game is mapped onto a system of linear equations.
Conversely, it can be verified that given
<!-- MATH
 $A \mathbf{x} = \mathbf{b}$
 -->
<IMG
 WIDTH="56" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img9.png"
 ALT="$ A \mathbf{x} = \mathbf{b}$">,
where <IMG
 WIDTH="15" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img10.png"
 ALT="$ A$"> is a symmetric diagonally-dominant
M-matrix, we can always construct a random walk game that is
mathematically equivalent, in which the set of <IMG
 WIDTH="13" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img11.png"
 ALT="$ f$"> values is
equal to the solution vector <!-- MATH
 $\mathbf{x}$
 -->
<IMG
 WIDTH="13" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img12.png"
 ALT="$ \mathbf{x}$">. To find the
<!-- MATH
 $i^{\rm th}$
 -->
<IMG
 WIDTH="21" HEIGHT="17" ALIGN="BOTTOM" BORDER="0"
 SRC="img13.png"
 ALT="$ i^{\rm th}$"> entry of <!-- MATH
 $\mathbf{x}$
 -->
<IMG
 WIDTH="13" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img12.png"
 ALT="$ \mathbf{x}$">, one may run a number of
walks from node <IMG
 WIDTH="9" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img2.png"
 ALT="$ i$"> and take the average of the results; to
get the complete solution, one may repeat the process for
every entry of <!-- MATH
 $\mathbf{x}$
 -->
<IMG
 WIDTH="13" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img12.png"
 ALT="$ \mathbf{x}$">. We alter this normal procedure
by adding the following rule: every calculated node becomes
a new home in the game with an award amount equal to its
calculated <IMG
 WIDTH="13" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img11.png"
 ALT="$ f$"> value. Without loss of generality, suppose
the nodes are in the natural ordering <!-- MATH
 $1,2,\cdots,N$
 -->
<IMG
 WIDTH="79" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img14.png"
 ALT="$ 1,2,\cdots,N$">, then
for walks starting from node <IMG
 WIDTH="9" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img2.png"
 ALT="$ i$">, the node set
<!-- MATH
 $\{1,2,\cdots,i-1\}$
 -->
<IMG
 WIDTH="113" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img15.png"
 ALT="$ \{1,2,\cdots,i-1\}$"> are homes where walks terminate (in
addition to homes generated from the
strictly-diagonally-dominant rows of <IMG
 WIDTH="15" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img10.png"
 ALT="$ A$">), while the node
set <!-- MATH
 $\{i,i+1,\cdots,N\}$
 -->
<IMG
 WIDTH="117" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img16.png"
 ALT="$ \{i,i+1,\cdots,N\}$"> are motels where walks pass by.

<P>
Define the operator <!-- MATH
 ${\rm rev}(\cdot)$
 -->
<IMG
 WIDTH="42" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img17.png"
 ALT="$ {\rm rev}(\cdot)$"> on square matrices
such that it reverses the ordering of the rows and reverses
the ordering of the columns: <!-- MATH
 ${\rm
rev}(A)_{i,j}=A_{N+1-i,N+1-j} , \quad \forall i,j \in \{
1,2,\cdots,N \}$
 -->
<IMG
 WIDTH="350" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img18.png"
 ALT="$ {\rm
rev}(A)_{i,j}=A_{N+1-i,N+1-j} , \quad \forall i,j \in \{
1,2,\cdots,N \}$">. Let the exact LDL factorization of <!-- MATH
 ${\rm
rev}(A)$
 -->
<IMG
 WIDTH="49" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img19.png"
 ALT="$ {\rm
rev}(A)$"> be <!-- MATH
 ${\rm rev}(A) = L_{{\rm rev}(A)} D_{{\rm
rev}(A)} \left( L_{{\rm rev}(A)} \right)^{\rm T}$
 -->
<IMG
 WIDTH="246" HEIGHT="43" ALIGN="MIDDLE" BORDER="0"
 SRC="img20.png"
 ALT="$ {\rm rev}(A) = L_{{\rm rev}(A)} D_{{\rm
rev}(A)} \left( L_{{\rm rev}(A)} \right)^{\rm T}$">. Again, in
the random walk game, assume that the nodes are in the
natural ordering <!-- MATH
 $1,2,\cdots,N$
 -->
<IMG
 WIDTH="79" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img14.png"
 ALT="$ 1,2,\cdots,N$">, and that node <IMG
 WIDTH="9" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img2.png"
 ALT="$ i$">
corresponds to the <!-- MATH
 $i^{\rm th}$
 -->
<IMG
 WIDTH="21" HEIGHT="17" ALIGN="BOTTOM" BORDER="0"
 SRC="img13.png"
 ALT="$ i^{\rm th}$"> row of <IMG
 WIDTH="15" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img10.png"
 ALT="$ A$">. We prove the
following relations:
<BR>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{eqnarray*}
\left( L_{{\rm rev}(A)} \right)_{i,j} & \approx &
- \frac{M_{N+1-j,N+1-i}}{W_{N+1-j}}, \quad\forall i>j \\
\left( D_{{\rm rev}(A)} \right)_{i,i} & \approx &
\frac{W_{N+1-i} A_{N+1-i,N+1-i}} {J_{N+1-i}}
\end{eqnarray*}
 -->
<TABLE CELLPADDING="0" ALIGN="CENTER" WIDTH="100%">
<TR VALIGN="MIDDLE"><TD NOWRAP ALIGN="RIGHT"><IMG
 WIDTH="81" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="img21.png"
 ALT="$\displaystyle \left( L_{{\rm rev}(A)} \right)_{i,j}$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG
 WIDTH="15" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img22.png"
 ALT="$\displaystyle \approx$"></TD>
<TD ALIGN="LEFT" NOWRAP><IMG
 WIDTH="190" HEIGHT="52" ALIGN="MIDDLE" BORDER="0"
 SRC="img23.png"
 ALT="$\displaystyle - \frac{M_{N+1-j,N+1-i}}{W_{N+1-j}}, \quad\forall i&gt;j$"></TD>
<TD WIDTH=10 ALIGN="RIGHT">
&nbsp;</TD></TR>
<TR VALIGN="MIDDLE"><TD NOWRAP ALIGN="RIGHT"><IMG
 WIDTH="82" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="img24.png"
 ALT="$\displaystyle \left( D_{{\rm rev}(A)} \right)_{i,i}$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG
 WIDTH="15" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img22.png"
 ALT="$\displaystyle \approx$"></TD>
<TD ALIGN="LEFT" NOWRAP><IMG
 WIDTH="165" HEIGHT="52" ALIGN="MIDDLE" BORDER="0"
 SRC="img25.png"
 ALT="$\displaystyle \frac{W_{N+1-i} A_{N+1-i,N+1-i}} {J_{N+1-i}}$"></TD>
<TD WIDTH=10 ALIGN="RIGHT">
&nbsp;</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL">

where <IMG
 WIDTH="26" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img26.png"
 ALT="$ W_k$"> is the total number of walks that are carried
out from node <IMG
 WIDTH="12" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img27.png"
 ALT="$ k$">, <!-- MATH
 $M_{k_1,k_2}$
 -->
<IMG
 WIDTH="49" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img28.png"
 ALT="$ M_{k_1,k_2}$"> is the number of walks that
start from node <IMG
 WIDTH="18" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img29.png"
 ALT="$ k_1$"> and end at <IMG
 WIDTH="18" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img30.png"
 ALT="$ k_2$">, and <IMG
 WIDTH="20" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img31.png"
 ALT="$ J_{k}$"> is the
number of times that the <IMG
 WIDTH="26" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img26.png"
 ALT="$ W_k$"> walks from node <IMG
 WIDTH="12" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img27.png"
 ALT="$ k$"> pass node
<IMG
 WIDTH="12" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img27.png"
 ALT="$ k$"> itself. These equations show that we can approximate an
LDL factorization by collecting information from random
walks. We further prove that if <!-- MATH
 $\left( L_{{\rm rev}(A)}
\right)_{i,j} = 0$
 -->
<IMG
 WIDTH="110" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="img32.png"
 ALT="$ \left( L_{{\rm rev}(A)}
\right)_{i,j} = 0$"> then <!-- MATH
 $M_{N+1-j,N+1-i} = 0$
 -->
<IMG
 WIDTH="137" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img33.png"
 ALT="$ M_{N+1-j,N+1-i} = 0$">; in other
words, the nonzero pattern of the <IMG
 WIDTH="14" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img34.png"
 ALT="$ L$"> factor produced by
random walks is a subset of nonzero pattern of the exact
<!-- MATH
 $L_{{\rm rev}(A)}$
 -->
<IMG
 WIDTH="52" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img35.png"
 ALT="$ L_{{\rm rev}(A)}$">. Therefore, we conclude that an
incomplete LDL factorization can be obtained from random
walks.

<P>
We argue that the obtained incomplete LDL factors
have better quality, i.e., better accuracy-size tradeoffs,
than the incomplete Cholesky factor obtained by a
traditional method based on Gaussian elimination. Our
argument is based on the fact that each row in the <IMG
 WIDTH="14" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img34.png"
 ALT="$ L$">
factor is independently calculated and has no correlation
with the computation of other rows. Therefore we avoid the
error accumulation in traditional incomplete factorization
procedure.

<P>
We also discuss, by defining a new set of game
rules, how this theory can be extended to general matrices,
given that the diagonal entries are nonzero.

<P>
To evaluate
the proposed approach, a set of benchmark matrices are
generated by Y.&nbsp;Saad's SPARSKIT by finite-difference
discretization of the 3D Laplace's equation
<!-- MATH
 $\nabla^2 u = 0$
 -->
<IMG
 WIDTH="62" HEIGHT="17" ALIGN="BOTTOM" BORDER="0"
 SRC="img36.png"
 ALT="$ \nabla^2 u = 0$">
with Dirichlet boundary condition. The matrices
correspond to 3D grids with sizes
<!-- MATH
 $50\times 50\times 50$
 -->
<IMG
 WIDTH="90" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img37.png"
 ALT="$ 50\times 50\times 50$">,
<!-- MATH
 $60\times 60\times 60$
 -->
<IMG
 WIDTH="90" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img38.png"
 ALT="$ 60\times 60\times 60$">, up to
<!-- MATH
 $100\times 100\times 100$
 -->
<IMG
 WIDTH="114" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img39.png"
 ALT="$ 100\times 100\times 100$">, and a
right-hand-side vector with all entries being 1 is used with
each of them. We compare the proposed solver, i.e., random
walk preconditioned conjugate gradient, against ICCG with
ILU(0) and ICCG with ILUT. The complexity metric is the
number of double-precision multiplications needed at the
iterative solving stage, in order to converge with an error
tolerance of <IMG
 WIDTH="36" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img40.png"
 ALT="$ 10^{-6}$">. The results show up to 2.1 times
speedup over ICCG, and a trend that the larger and denser a
matrix is, the more the proposed solver outperforms ICCG.

<P>
This talk is partially based on [1], and the
implementation is available to the public [2].

<P>
[1]
H.&nbsp;Qian, S.&nbsp;S.&nbsp;Sapatnekar, <EM>A hybrid linear equation
solver and its application in quadratic placement</EM>,
IEEE/ACM International Conference on Computer Aided
Design Digest of Technical Papers (2005) 905-909.

<P>
[2] H.&nbsp;Qian, S.&nbsp;S.&nbsp;Sapatnekar,
<EM>The Hybrid Linear Equation Solver Binary Release</EM>,
available at http://www.ece.umn.edu/users/qianhf/hybridsolver

<P>
<BR><HR>
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"></A>

<UL>
<LI><A NAME="tex2html4"
  HREF="node1.html">About this document ...</A>
</UL>
<!--End of Table of Child-Links-->
<HR>
<!--Navigation Panel-->
<A NAME="tex2html2"
  HREF="node1.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="http://amath.colorado.edu/PNGs/icons.png/next.png"></A> 
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="http://amath.colorado.edu/PNGs/icons.png/up_g.png"> 
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="http://amath.colorado.edu/PNGs/icons.png/prev_g.png">   
<BR>
<B> Next:</B> <A NAME="tex2html3"
  HREF="node1.html">About this document ...</A>
<!--End of Navigation Panel-->
<ADDRESS>
Bruce Fast
2006-03-11
</ADDRESS>
</BODY>
</HTML>
