<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.70)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>duffi083355</TITLE>
<META NAME="description" CONTENT="duffi083355">
<META NAME="keywords" CONTENT="duffi083355">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="next" HREF="node1.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html193"
  HREF="node1.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/share/latex2html/icons/next.png"></A> 
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/share/latex2html/icons/up_g.png"> 
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/share/latex2html/icons/prev_g.png">   
<BR>
<B> Next:</B> <A NAME="tex2html194"
  HREF="node1.html">Bibliography</A>
<BR>
<BR>
<!--End of Navigation Panel-->
<DIV ALIGN="CENTER">
  <FONT SIZE="+1">Iain S. Duff 
<BR><B>Using FGMRES to obtain backward stability in mixed precision</B></FONT>
</DIV>
<P>
<DIV ALIGN="CENTER">STFC - Rutherford Appleton Laboratory 
<BR>
Chilton 
<BR>
Didcot 
<BR>
UK OX11 0QX

<BR><TT>i.s.duff@rl.ac.uk</TT>
<BR>
Mario Arioli
</DIV>

<P>

<P>
We are concerned with the solution of
<P></P>
<DIV ALIGN="CENTER"><A NAME="eqn:axb"></A><!-- MATH
 \begin{equation}
A x ~=~ b,
\end{equation}
 -->
<TABLE CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><IMG
 WIDTH="69" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img1.png"
 ALT="$\displaystyle A x ~=~ b,$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
(1)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
when <IMG
 WIDTH="16" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img2.png"
 ALT="$ A$"> is an <!-- MATH
 $n \times n$
 -->
<IMG
 WIDTH="43" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img3.png"
 ALT="$ n \times n$"> matrix and <IMG
 WIDTH="14" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$ x$"> and <IMG
 WIDTH="11" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img5.png"
 ALT="$ b$">
are vectors of length <IMG
 WIDTH="14" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img6.png"
 ALT="$ n$">. We will solve these systems using
a direct
method where the matrix <IMG
 WIDTH="16" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img2.png"
 ALT="$ A$"> is first factorized as <!-- MATH
 \begin{displaymath}
A \rightarrow LU,
\end{displaymath}
 -->
<P></P>
<DIV ALIGN="CENTER">
<IMG
 WIDTH="67" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img7.png"
 ALT="$\displaystyle A \rightarrow LU,$">
</DIV><P></P>
where <IMG
 WIDTH="15" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img8.png"
 ALT="$ L$"> and <IMG
 WIDTH="17" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img9.png"
 ALT="$ U$"> are triangular matrices. The solution is then obtained
through forward elimination <!-- MATH
 \begin{displaymath}
Ly = b
\end{displaymath}
 -->
<P></P>
<DIV ALIGN="CENTER">
<IMG
 WIDTH="52" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$\displaystyle Ly = b$">
</DIV><P></P>
followed by back substitution
<!-- MATH
 \begin{displaymath}
Ux = y,
\end{displaymath}
 -->
<P></P>
<DIV ALIGN="CENTER">
<IMG
 WIDTH="60" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img11.png"
 ALT="$\displaystyle Ux = y,$">
</DIV><P></P>
where we have omitted permutations required for numerical
stability and sparsity preservation for the sake of clarity. When
<IMG
 WIDTH="16" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img2.png"
 ALT="$ A$"> is symmetric we use an <IMG
 WIDTH="50" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img12.png"
 ALT="$ LDL^T$"> factorization where the matrix
<IMG
 WIDTH="18" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img13.png"
 ALT="$ D$"> is block diagonal with blocks of order 1 and 2, so that we can stably
factorize indefinite systems.

<P>
On many emerging computer architectures, the use of single precision
arithmetic (by which we mean working with 32-bit floating-point numbers)
is faster than using double precision. In fact on the Cell processor,
single precision working can be more than ten times as fast as using double
precision [<A
 HREF="node1.html#bdll:07">2</A>]. In addition, half the storage is required
when using single
precision and the movement of data between memory hierarchies and cache
and processing units is much reduced. However, in many applications, a higher
accuracy is required than single precision (with a value of machine
precision around <IMG
 WIDTH="37" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img14.png"
 ALT="$ 10^{-7}$">) or the matrix can be so ill-conditioned
that single precision working is unable to obtain accuracy to even
one significant figure .... that is the results are meaningless.

<P>
We show how the selective use of double precision
post-processing can enable solutions with a backward error (scaled residual)
of double precision accuracy (around <IMG
 WIDTH="44" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img15.png"
 ALT="$ 10^{-16}$">) even when the
factorization is computed in single precision We show that the use
of iterative refinement in double precision may fail when the matrix
is ill-conditioned and then show that, even for such badly behaved matrices,
the use of FGMRES [<A
 HREF="node1.html#saad:93">3</A>] can produce answers to the desired
level of accuracy,
namely that the solution process using FGMRES is backward stable at the
level of double precision. In [<A
 HREF="node1.html#ardu08">1</A>], we prove that, under
realistic assumptions on
the matrix and the factorization, the computation in mixed
precision, where the LU factorization is computed in single precision and
the FGMRES iteration in double precision, gives a backward stable algorithm.

<P>
We perform an extensive series of tests using MATLAB on random dense matrices
constructed to have specific condition numbers and singular value
distribution. We compute the key quantities that appear in our theoretical
analysis and show that these support our theory. As one main future
development of this
work is to study the effective solution of large sparse systems on
multicore architectures, we then perform numerical experiments on a set of
sparse matrices using a combination of Fortran and MATLAB.

<P>
We show the results of runs on some rather ill-conditioned sparse matrices in
Table&nbsp;<A HREF="#tab:7"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]"
 SRC="file:/usr/share/latex2html/icons/crossref.png"></A>. In this case we use restarted FGMRES since the cost of
keeping
too many vectors can be high for these larger dimensioned systems. We
note that although iterative refinement essentially converges on the first
three examples, it is still not as accurate as FGMRES and requires many more
iterations than FGMRES.
On the last example, the convergence of iterative refinement was so slow that
we stopped after 53 iterations.
<BR><P></P>
<DIV ALIGN="CENTER"><A NAME="42"></A>
<TABLE>
<CAPTION><STRONG>Table:</STRONG>
Sparse matrices results.</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER"><TABLE CELLPADDING=3 BORDER="1">
<TR><TD ALIGN="CENTER"><FONT SIZE="-1">
Matrix Id</FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> <IMG
 WIDTH="14" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img6.png"
 ALT="$ n$"> </FONT></TD>
<TD ALIGN="CENTER" COLSPAN=2><FONT SIZE="-1"> Iterative
refinement</FONT></TD>
<TD ALIGN="CENTER" COLSPAN=3><FONT SIZE="-1">FGMRES</FONT></TD>
</TR>
<TR><TD ALIGN="CENTER"><FONT SIZE="-1">  
</FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1">Total It </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> <!-- MATH
 ${\displaystyle \frac{|| b -A \bar{x}_{\hat{k}}||}{(||A|| \,
||\bar{x}_{\hat{k}}|| + ||b||)}}$
 -->
<IMG
 WIDTH="132" HEIGHT="55" ALIGN="MIDDLE" BORDER="0"
 SRC="img16.png"
 ALT="$ {\displaystyle \frac{\vert\vert b -A \bar{x}_{\hat{k}}\vert\vert}{(\vert\vert A\vert\vert \,
\vert\vert\bar{x}_{\hat{k}}\vert\vert + \vert\vert b\vert\vert)}}$"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1">Total It </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1">Inner it </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> <!-- MATH
 ${\displaystyle
\frac{|| b -A \bar{x}_{\hat{k}}||}{(||A|| \, ||\bar{x}_{\hat{k}}|| + ||b||)}}$
 -->
<IMG
 WIDTH="132" HEIGHT="55" ALIGN="MIDDLE" BORDER="0"
 SRC="img16.png"
 ALT="$ {\displaystyle \frac{\vert\vert b -A \bar{x}_{\hat{k}}\vert\vert}{(\vert\vert A\vert\vert \,
\vert\vert\bar{x}_{\hat{k}}\vert\vert + \vert\vert b\vert\vert)}}$"> </FONT></TD>
</TR>
<TR><TD ALIGN="CENTER"><FONT SIZE="-1"> 

bcsstk20 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 485 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1">30</FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 2.1e-15 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 2 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 2 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 1.4e-11 </FONT></TD>
</TR>
<TR><TD ALIGN="CENTER"><FONT SIZE="-1"> 
</FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 4 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 2 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 3.4e-14 </FONT></TD>
</TR>
<TR><TD ALIGN="CENTER"><FONT SIZE="-1"> 
</FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 6 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 2 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 7.2e-17 </FONT></TD>
</TR>
<TR><TD ALIGN="CENTER"><FONT SIZE="-1">  
bcsstm27</FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 1224 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1">22</FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1">1.6e-15 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 2 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 2 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 5.8e-11 </FONT></TD>
</TR>
<TR><TD ALIGN="CENTER"><FONT SIZE="-1"> 
</FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 4 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 2 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 1.8e-11 </FONT></TD>
</TR>
<TR><TD ALIGN="CENTER"><FONT SIZE="-1"> 
</FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 6 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 2 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 6.0e-13 </FONT></TD>
</TR>
<TR><TD ALIGN="CENTER"><FONT SIZE="-1"> 
</FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 8 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 2 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1">1.5e-13 </FONT></TD>
</TR>
<TR><TD ALIGN="CENTER"><FONT SIZE="-1"> 
</FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1">10</FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1">2 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1">1.2e-14 </FONT></TD>
</TR>
<TR><TD ALIGN="CENTER"><FONT SIZE="-1"> 
</FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1">12</FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1">2 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1">2.6e-15 </FONT></TD>
</TR>
<TR><TD ALIGN="CENTER"><FONT SIZE="-1"> 
</FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1">14</FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1">2 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1">1.8e-16 </FONT></TD>
</TR>
<TR><TD ALIGN="CENTER"><FONT SIZE="-1">  
s3rmq4m1</FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 5489 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1">16</FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 2.2e-15 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 2</FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1">2 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1">3.5e-11 </FONT></TD>
</TR>
<TR><TD ALIGN="CENTER"><FONT SIZE="-1"> 
</FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 4 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1">2 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 2.1e-13 </FONT></TD>
</TR>
<TR><TD ALIGN="CENTER"><FONT SIZE="-1"> 
</FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 6 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1">2 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1">4.5e-15 </FONT></TD>
</TR>
<TR><TD ALIGN="CENTER"><FONT SIZE="-1"> 
</FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 8 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1">2 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1">1.1e-16 </FONT></TD>
</TR>
<TR><TD ALIGN="CENTER"><FONT SIZE="-1">  
s3dkq4m2</FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 90449</FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1">53</FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1">1.1e-10 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1">10 </FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 10</FONT></TD>
<TD ALIGN="CENTER"><FONT SIZE="-1"> 6.3e-17 </FONT></TD>
</TR>
</TABLE></DIV><FONT SIZE="-1">
<BR>
<BR>

<A NAME="tab:7"></A></FONT></TD></TR>
</TABLE>
</DIV><P></P>
<BR>

<P>
<BR><HR>
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"></A>

<UL>
<LI><A NAME="tex2html195"
  HREF="node1.html">Bibliography</A>
<LI><A NAME="tex2html196"
  HREF="node2.html">About this document ...</A>
</UL>
<!--End of Table of Child-Links-->
<HR>
<!--Navigation Panel-->
<A NAME="tex2html193"
  HREF="node1.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/share/latex2html/icons/next.png"></A> 
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/share/latex2html/icons/up_g.png"> 
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/share/latex2html/icons/prev_g.png">   
<BR>
<B> Next:</B> <A NAME="tex2html194"
  HREF="node1.html">Bibliography</A>
<!--End of Navigation Panel-->
<ADDRESS>
Marian
2008-02-26
</ADDRESS>
</BODY>
</HTML>
